# 卡牌游戏独立创建模式测试清单

## 测试前准备

1. 确保数据库已初始化（已执行 `init_game_core_simple.sql`）
2. 确保有"卡牌游戏"类别和"卡牌对战"模板
3. 启动开发服务器：`npm run dev`

## 功能测试

### 1. 模式切换测试

#### 1.1 从融合模式切换到类别模式
- [ ] 进入 Game Lab 页面
- [ ] 点击"显示高级选项"
- [ ] 在"游戏类别"标签中选择"卡牌游戏"
- [ ] **预期结果**：
  - 自动切换到类别创建模式
  - 显示模式指示器"类别创建模式"
  - "已选游戏"区域隐藏
  - "游戏类型"网格隐藏
  - 显示"类别创建"界面

#### 1.2 从类别模式切换回融合模式
- [ ] 在类别模式下，点击已选类别旁边的 X 按钮，或点击"切换到融合模式"按钮
- [ ] **预期结果**：
  - 切换到融合模式
  - 模式指示器消失
  - 显示"已选游戏"区域
  - 显示"游戏类型"网格
  - 类别选择保留在高级选项中

### 2. 类别创建模式 UI 测试

#### 2.1 类别选择
- [ ] 切换到类别模式
- [ ] **预期结果**：
  - 显示已选类别卡片（带图标和描述）
  - 显示取消按钮（X）

#### 2.2 模板选择
- [ ] 在类别模式下选择模板
- [ ] **预期结果**：
  - 显示该类别下的所有模板
  - 可以预览模板
  - 可以选择模板
  - 显示"不使用模板"选项

#### 2.3 自定义描述输入
- [ ] 在类别模式下，在文本框中输入自定义描述
- [ ] **预期结果**：
  - 可以正常输入文本
  - 占位符文本正确显示
  - 提示信息正确显示

### 3. 验证逻辑测试

#### 3.1 类别模式验证
- [ ] 在类别模式下，不选择模板，不输入自定义描述，点击"生成游戏"
- [ ] **预期结果**：显示错误提示"请选择模板或输入自定义描述"

- [ ] 在类别模式下，选择模板，点击"生成游戏"
- [ ] **预期结果**：按钮可用，开始生成

- [ ] 在类别模式下，输入自定义描述（不选择模板），点击"生成游戏"
- [ ] **预期结果**：按钮可用，开始生成

- [ ] 在类别模式下，既选择模板又输入自定义描述，点击"生成游戏"
- [ ] **预期结果**：使用自定义描述生成游戏

#### 3.2 融合模式验证
- [ ] 在融合模式下，选择少于2个游戏类型，点击"开始融合！"
- [ ] **预期结果**：显示错误提示"至少选择 2 个游戏才能开始融合"

- [ ] 在融合模式下，选择2个游戏类型，点击"开始融合！"
- [ ] **预期结果**：按钮可用，开始融合

### 4. 生成逻辑测试

#### 4.1 类别模式生成
- [ ] 选择"卡牌游戏"类别
- [ ] 选择"卡牌对战"模板
- [ ] 点击"生成游戏"
- [ ] **预期结果**：
  - 显示加载动画（显示类别图标和模板图标）
  - 不调用 `fuseGames` API
  - 直接调用 `generateGame` API，传入：
    - `categoryId`: 卡牌游戏类别 ID
    - `templateId`: 卡牌对战模板 ID
    - `prompt`: 基于模板的提示
  - 生成成功，显示游戏结果

#### 4.2 类别模式 + 自定义描述生成
- [ ] 选择"卡牌游戏"类别
- [ ] 不选择模板
- [ ] 输入自定义描述："一个创新的卡牌收集游戏"
- [ ] 点击"生成游戏"
- [ ] **预期结果**：
  - 调用 `generateGame` API，传入：
    - `categoryId`: 卡牌游戏类别 ID
    - `prompt`: "一个创新的卡牌收集游戏"
  - 生成成功，显示游戏结果

#### 4.3 融合模式生成（原有功能）
- [ ] 切换到融合模式
- [ ] 选择2-3个游戏类型（如"贪吃蛇"和"俄罗斯方块"）
- [ ] 点击"开始融合！"
- [ ] **预期结果**：
  - 显示加载动画（显示选中的游戏类型）
  - 调用 `fuseGames` API
  - 调用 `generateGame` API，传入融合结果
  - 生成成功，显示游戏结果

### 5. UI 显示测试

#### 5.1 按钮文本
- [ ] 在类别模式下，按钮文本显示为"生成游戏"（中文）或 "Generate Game"（英文）
- [ ] 在融合模式下，按钮文本显示为"开始融合！"（中文）或 "Start Fusion!"（英文）

#### 5.2 加载状态
- [ ] 在类别模式下生成时，加载文本显示为"生成中..."（中文）或 "Generating..."（英文）
- [ ] 在融合模式下生成时，加载文本显示为"融合中..."（中文）或 "Fusing..."（英文）

#### 5.3 加载动画
- [ ] 类别模式下：显示类别图标和模板图标（如果有）
- [ ] 融合模式下：显示选中的游戏类型图标和融合符号

### 6. 游戏结果测试

#### 6.1 保存游戏
- [ ] 生成成功后，点击"开始游戏"
- [ ] **预期结果**：
  - 类别模式：prompt 使用类别和模板信息
  - 融合模式：prompt 使用游戏类型列表
  - 正确保存到数据库
  - 正确跳转到 Studio 页面

### 7. 边界情况测试

#### 7.1 切换模式时的状态清理
- [ ] 在融合模式下选择2个游戏类型
- [ ] 切换到类别模式
- [ ] **预期结果**：已选游戏类型被清空

- [ ] 在类别模式下选择类别和模板
- [ ] 切换到融合模式
- [ ] **预期结果**：类别和模板选择保留在高级选项中

#### 7.2 同时满足两种模式的条件
- [ ] 在融合模式下，选择了2个游戏类型，同时在高级选项中选择了类别
- [ ] **预期结果**：自动切换到类别模式，忽略游戏类型选择

## 国际化测试

- [ ] 切换到中文，验证所有新添加的文本都正确显示中文
- [ ] 切换到英文，验证所有新添加的文本都正确显示英文
- [ ] 验证错误提示也正确国际化

## 响应式测试

- [ ] 在移动设备上测试类别创建模式
- [ ] 在平板设备上测试类别创建模式
- [ ] 验证所有 UI 元素在不同屏幕尺寸下正常显示

## 性能测试

- [ ] 快速切换模式多次，验证没有内存泄漏
- [ ] 在生成过程中切换模式，验证正确处理

## 已知问题

无

## 测试结果

| 测试项 | 状态 | 备注 |
|--------|------|------|
| 模式切换 | ⬜ | |
| 类别创建 UI | ⬜ | |
| 验证逻辑 | ⬜ | |
| 生成逻辑 | ⬜ | |
| UI 显示 | ⬜ | |
| 游戏结果 | ⬜ | |
| 边界情况 | ⬜ | |
| 国际化 | ⬜ | |
| 响应式 | ⬜ | |
| 性能 | ⬜ | |
